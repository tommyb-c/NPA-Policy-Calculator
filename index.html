<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NPA Policy Calculator</title>

  <link rel="icon" type="image/png" href="https://yournpa.wordpress.com/wp-content/uploads/2025/05/cropped-npa-website-favicon.png">

  <link href="https://fonts.googleapis.com/css2?family=Epilogue:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand-bg:#fef9eb;
      --card-bg:#fef9eb;
      --body-text:#151a29;
      --btn-bg:#84163B;
      --btn-text:#fef9eb;
      --field-border:#d6d8df;
      --accent:#84163B;
      --radius:12px;
      --max-width:760px;
    }

    html,body{
      height:100%;
      margin:0;
      background:var(--brand-bg);
      font-family:"Epilogue",system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--body-text);
    }

    .wrap{
      min-height:100%;
      display:flex;
      justify-content:center;
      padding:28px;
    }

    .card{
      width:100%;
      max-width:var(--max-width);
      background:var(--card-bg);
      border-radius:18px;
      padding:32px;
      box-shadow:0 10px 30px rgba(8,20,40,.12);
    }

    .logo{
      display:block;
      margin:0 0 18px 0;
      max-width:240px;
    }

    h1{font-size:22px;margin:0 0 8px;font-weight:600;}
    .lead{margin:0 0 22px;font-size:14px;color:#35404f;}

    .field{margin-bottom:14px;}
    label{display:block;font-size:13px;margin-bottom:6px;font-weight:600;}
    input{
      width:100%;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid var(--field-border);
      font-size:15px;
    }

    .btn{
      width:100%;
      padding:12px;
      background:var(--btn-bg);
      color:var(--btn-text);
      font-weight:700;
      border-radius:14px;
      border:none;
      cursor:pointer;
      font-size:16px;
    }

    .result{
      margin-top:18px;
      padding:16px;
      background:#f4f6fb;
      border-radius:12px;
      border-left:4px solid var(--accent);
      display:none;
    }

    .amount{
      margin-top:8px;
      font-size:22px;
      font-weight:700;
      color:var(--btn-bg);
    }

    .message{margin-top:10px;font-size:14px;}
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <img class="logo" src="https://yournpa.wordpress.com/wp-content/uploads/2025/05/npa-logo-colored-full-edited.png" alt="NPA logo">

    <h1>Calculating the Policy for Your Service Center</h1>
    <p class="lead">Enter your details below to estimate a policy amount.</p>

    <div class="field">
      <label>Service Center Name</label>
      <input id="centerName" type="text">
    </div>

    <div class="field">
      <label>Number of Facilitators</label>
      <input id="facilitators" type="number" min="0" value="0">
    </div>

    <div class="field">
      <label>Number of Administrative Staff</label>
      <input id="admins" type="number" min="0" value="0">
    </div>

    <button id="calcBtn" class="btn">Calculate Policy</button>

    <div id="resultBox" class="result">
      <div id="resultText"></div>
      <div id="resultAmount" class="amount"></div>
    </div>

    <div id="message" class="message" style="display:none;"></div>
  </div>
</div>

<script>
(function(){
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbz6MPIiURVwQOdvmoZCwfqCOE_7UvEFyYkblevXR2APuBG620icKIuznh_5nxZt2UNE/exec';
  const TOKEN = 'npa-2025-policy-calculator';

  function computePolicy(A,B){
    return (966*0.08)*A + (355*1.08)*B + (3130*0.5);
  }

  function formatUSD(n){
    return n.toLocaleString('en-US',{style:'currency',currency:'USD'});
  }

  async function postSubmission(payload){
    try{
      await fetch(ENDPOINT,{
        method:'POST',
        mode:'no-cors',
        headers:{'Content-Type':'application/x-www-form-urlencoded'},
        body:new URLSearchParams(payload).toString()
      });
      return true;
    }catch(e){
      return false;
    }
  }

  document.getElementById('calcBtn').addEventListener('click', async () => {
    const A = Number(document.getElementById('facilitators').value||0);
    const B = Number(document.getElementById('admins').value||0);
    const name = document.getElementById('centerName').value.trim();

    if(A===0 && B===0){
      show('Please enter at least one staff member.',true);
      return;
    }

    const policy = computePolicy(A,B);

    document.getElementById('resultText').textContent =
      name ? `Estimated policy for ${name}` : 'Estimated policy amount';
    document.getElementById('resultAmount').textContent = formatUSD(policy);
    document.getElementById('resultBox').style.display='block';

    show('Saving your submission…');

    const ok = await postSubmission({
      token:TOKEN,
      service_center:name,
      facilitators:A,
      admins:B,
      policy_amount:policy,
      page_url:location.href,
      user_agent:navigator.userAgent,
      notes:''
    });

    show(
      ok
        ? 'Thanks — your inputs have been recorded.'
        : 'Network issue saving submission. Calculation shown above.',
      !ok
    );
  });

  function show(msg,isError){
    const el=document.getElementById('message');
    el.textContent=msg;
    el.style.display='block';
    el.style.color=isError?'#b22222':'#2d7a2d';
  }
})();
</script>
</body>
</html>
